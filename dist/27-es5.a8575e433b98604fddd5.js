function _classCallCheck(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,o){for(var i=0;i<o.length;i++){var a=o[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,o,i){return o&&_defineProperties(t.prototype,o),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"914F":function(t,o,i){"use strict";i.r(o),i.d(o,"PartilhaListaModule",(function(){return j}));var a=i("ofXK"),n=i("tyNb"),e=i("lKi6"),c=i("cnyc"),r=i("cHAT"),b=i("sWYD"),s=i("vI6V"),l=i("v8Ly"),u=i("JX91"),d=i("lJxs"),v=i("zeoc"),f=i("3Pt+"),p=i("fXoL"),h=i("aceb"),m=i("TT0I");function X(t,o){if(1&t&&p.Tb(0,"textarea",5),2&t){var i=p.kc(2);p.rc("formControl",i.justificativa)}}function Y(t,o){if(1&t&&(p.Yb(0,"div"),p.Yb(1,"nb-checkbox",3),p.Jc(2,"Aprovar comprovante(s)"),p.Xb(),p.Hc(3,X,1,1,"textarea",4),p.Xb()),2&t){var i=p.kc();p.Fb(1),p.rc("formControl",i.aprovado),p.Fb(2),p.rc("ngIf",!i.aprovado.value)}}function g(t,o){if(1&t&&(p.Yb(0,"div"),p.Yb(1,"div",6),p.Yb(2,"div",7),p.Yb(3,"label",8),p.Jc(4,"Valor depositado"),p.Xb(),p.Tb(5,"input",9),p.Xb(),p.Yb(6,"div",7),p.Yb(7,"label",10),p.Jc(8,"Data do dep\xf3sito"),p.Xb(),p.Tb(9,"input",11),p.Tb(10,"nb-datepicker",null,12),p.Xb(),p.Xb(),p.Xb()),2&t){var i=p.yc(11),a=p.kc();p.Fb(5),p.rc("formControl",a.valorDepositado),p.Fb(4),p.rc("formControl",a.dataDeposito)("nbDatepicker",i)}}var k,y=((k=function(){function t(o){_classCallCheck(this,t),this.ref=o,this.aprovado=new f.d(!1),this.justificativa=new f.d(""),this.valorDepositado=new f.d(0),this.dataDeposito=new f.d(new Date)}return _createClass(t,[{key:"ngOnInit",value:function(){this.aprovar=this.status===s.c.EM_ANALISE,this.deposito=this.status===s.c.APROVADO}},{key:"cancel",value:function(){this.ref.close({submit:!1})}},{key:"submit",value:function(){this.ref.close({submit:!0,aprovacao:{aprovado:this.aprovado.value,justificativa:this.justificativa.value},deposito:{valorDepositado:this.valorDepositado.value,dataDeposito:this.dataDeposito.value}})}}]),t}()).\u0275fac=function(t){return new(t||k)(p.Sb(h.M))},k.\u0275cmp=p.Mb({type:k,selectors:[["ngx-dialog-showcase"]],inputs:{status:"status"},decls:11,vars:2,consts:[[4,"ngIf"],["nbButton","","status","danger",1,"cancel",3,"click"],["nbButton","","status","success",3,"click"],["fullWidth","",3,"formControl"],["fullWidth","","nbInput","","placeholder","Justificativa",3,"formControl",4,"ngIf"],["fullWidth","","nbInput","","placeholder","Justificativa",3,"formControl"],[1,"row"],[1,"col"],["for","valor",1,"label"],["shape","round","type","tel","nbInput","","currencyMask","","placeholder","Valor depositado","id","valor","maxlength","15",3,"formControl"],[1,"label"],["nbInput","",3,"formControl","nbDatepicker"],["dp",""]],template:function(t,o){1&t&&(p.Yb(0,"nb-card"),p.Yb(1,"nb-card-header"),p.Jc(2,"Confirme a altera\xe7\xe3o de status"),p.Xb(),p.Yb(3,"nb-card-body"),p.Hc(4,Y,4,2,"div",0),p.Hc(5,g,12,3,"div",0),p.Xb(),p.Yb(6,"nb-card-footer"),p.Yb(7,"button",1),p.gc("click",(function(){return o.cancel()})),p.Jc(8," Cancelar "),p.Xb(),p.Yb(9,"button",2),p.gc("click",(function(){return o.submit()})),p.Jc(10,"Alterar"),p.Xb(),p.Xb(),p.Xb()),2&t&&(p.Fb(4),p.rc("ngIf",o.aprovar),p.Fb(1),p.rc("ngIf",o.deposito))},directives:[h.x,h.A,h.w,a.n,h.y,h.t,h.D,f.n,f.e,h.S,f.b,m.a,f.i,h.J,h.I],styles:["input[_ngcontent-%COMP%]{width:100%}.cancel[_ngcontent-%COMP%]{margin-right:2rem}"]}),k),F=i("wHSu"),C=i("6NWb");function w(t,o){if(1&t&&(p.Yb(0,"nb-option",10),p.Jc(1),p.Xb()),2&t){var i=o.$implicit;p.rc("value",i.k),p.Fb(1),p.Kc(i.v)}}function S(t,o){if(1&t&&(p.Yb(0,"nb-option",10),p.Jc(1),p.Xb()),2&t){var i=o.$implicit;p.rc("value",i.n),p.Fb(1),p.Kc(i.mes)}}function A(t,o){if(1&t&&(p.Yb(0,"nb-option",10),p.Jc(1),p.Xb()),2&t){var i=o.$implicit;p.rc("value",i),p.Fb(1),p.Lc(" ",i.name," ")}}function J(t,o){if(1&t){var i=p.Zb();p.Yb(0,"div",21),p.Yb(1,"nb-checkbox",33),p.gc("checkedChange",(function(t){p.Bc(i);var o=p.kc().$implicit;return p.kc().toggle(t,o._id)})),p.Xb(),p.Xb()}if(2&t){var a=p.kc().$implicit,n=p.kc();p.Fb(1),p.rc("checked",n.isChecked(a._id))}}function D(t,o){if(1&t){var i=p.Zb();p.Yb(0,"nb-list-item"),p.Hc(1,J,2,1,"div",28),p.Yb(2,"div",21),p.Jc(3),p.Xb(),p.Yb(4,"div",21),p.Jc(5),p.Xb(),p.Yb(6,"div",21),p.Jc(7),p.Xb(),p.Yb(8,"div",21),p.Jc(9),p.lc(10,"currency"),p.Xb(),p.Yb(11,"div",21),p.Jc(12),p.lc(13,"currency"),p.Xb(),p.Yb(14,"div",21),p.Yb(15,"button",29),p.gc("click",(function(){p.Bc(i);var t=o.$implicit;return p.kc().downloadComprovante(t)})),p.Tb(16,"nb-icon",30),p.Xb(),p.Yb(17,"button",31),p.gc("click",(function(){p.Bc(i);var t=o.$implicit;return p.kc().mostrarAtividade(t)})),p.Tb(18,"nb-icon",32),p.Xb(),p.Xb(),p.Xb()}if(2&t){var a=o.$implicit,n=p.kc();p.Fb(1),p.rc("ngIf",n.podeAlterar()),p.Fb(2),p.Kc(a.usuario.name),p.Fb(2),p.Kc(n.mes(a.mes).abv),p.Fb(2),p.Kc(n.obterStatus(a.status)),p.Fb(2),p.Lc(" ",p.nc(10,7,a.valorComprovante,"R$")," "),p.Fb(3),p.Lc(" ",p.nc(13,10,a.valorDepositado,"R$")||"-"," "),p.Fb(3),p.rc("nbSpinner",n.loadingDownloading[a._id])}}function I(t,o){1&t&&(p.Yb(0,"div"),p.Jc(1," N\xe3o ha nenhuma atividade para este comprovante. "),p.Xb())}function O(t,o){if(1&t&&(p.Yb(0,"nb-list-item"),p.Yb(1,"div",21),p.Jc(2),p.Xb(),p.Yb(3,"div",21),p.Jc(4),p.Xb(),p.Yb(5,"div",21),p.Jc(6),p.Xb(),p.Xb()),2&t){var i=o.$implicit,a=p.kc();p.Fb(2),p.Kc(a.formataData(i.criadoEm)),p.Fb(2),p.Kc(i.atividade),p.Fb(2),p.Kc(i.descricao)}}var E,_,x,L=[{path:"",component:(E=function(){function t(o,i,a,n,b){_classCallCheck(this,t),this.fb=o,this.usuarioService=i,this.partilhaService=a,this.dialogService=n,this.toastrservice=b,this.meses=e.b,this.faExchangeAlt=F.f,this.anoAtual=Object(c.a)(new Date),this.filtroStatus="EM_ANALISE",this.statuss=Object.keys(s.c).map((function(t){return{k:t,v:s.c[t]}})),this.verAtividade=!1,this.checkeds=new Set,this.loadingLista=!1,this.loadingInfo=!1,this.loadingAlterarStatus=!1,this.loadingDownloading={},this.form=this.fb.group({ano:this.anoAtual,mes:Object(r.a)(new Date),usuario:null,status:"EM_ANALISE",dataPrevistaRecebimento:null}),this.caixa=0,this.enviaram=0,this.faltam=0,this.doado=0,this.depositado=0}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.loadingLista=!0,this.loadingInfo=!0,this.partilhaService.buscar(this.form.value).subscribe((function(o){t.comprovantes=o,t.comprovantes.forEach((function(o){return t.downloadComprovante[o._id]=!1}))}),(function(t){return t}),(function(){return t.loadingLista=!1})),this.partilhaService.valoresGestao(this.form.value).subscribe((function(o){t.caixa=o.caixa,t.enviaram=o.enviaram,t.faltam=o.faltam,t.doado=o.doado,t.depositado=o.depositado}),(function(t){return t}),(function(){return t.loadingInfo=!1})),this.form.controls.usuario.valueChanges.subscribe((function(o){return t.usuarios=t.usuarioService.seminaristasAtivosAutocomplete(o).pipe(Object(u.a)(""),Object(d.a)((function(t){return t||[]})))}))}},{key:"alterarStatus",value:function(){var t=this;this.loadingAlterarStatus=!0;var o=Array.from(this.checkeds);this.dialogService.open(y,{context:{status:s.c[this.filtroStatus]}}).onClose.subscribe((function(i){i.submit&&t.partilhaService.alterarStatus({ids:o,status:t.filtroStatus,justificativa:i.aprovacao.justificativa,aprovado:i.aprovacao.aprovado,valorDepositado:i.deposito.valorDepositado,dataDeposito:i.deposito.dataDeposito}).subscribe((function(o){t.toastrservice.success("","Status das solicita\xe7\xf5es foram alterados com sucesso"),t.buscar()}),(function(o){t.toastrservice.danger(o.error.errors,"Erro!")}),(function(){return t.loadingAlterarStatus=!1}))}))}},{key:"viewHandle",value:function(t){return t&&t.name?t.name:t}},{key:"buscar",value:function(){var t=this;this.loadingLista=!0,this.partilhaService.buscar(this.form.value).subscribe((function(o){t.comprovantes=o,t.filtroStatus=t.form.value.status,t.checkeds.clear(),t.comprovantes.forEach((function(o){return t.downloadComprovante[o._id]=!1}))}),(function(t){return t}),(function(){return t.loadingLista=!1}))}},{key:"mes",value:function(t){return Object(e.a)(t)}},{key:"obterStatus",value:function(t){return s.c[t]}},{key:"mostrarAtividade",value:function(t){this.comprovanteEscolhido=t,this.verAtividade=!0}},{key:"ocultarAtividade",value:function(){this.comprovanteEscolhido=null,this.verAtividade=!1}},{key:"toggle",value:function(t,o){t?this.checkeds.add(o):this.checkeds.delete(o)}},{key:"isChecked",value:function(t){return this.checkeds.has(t)}},{key:"formataData",value:function(t){return Object(b.a)(new Date(t),"dd/MM/yyyy")}},{key:"podeAlterar",value:function(){return"EM_ANALISE"===this.filtroStatus||"APROVADO"===this.filtroStatus}},{key:"downloadComprovante",value:function(t){var o=this;this.downloadComprovante[t._id]=!0,this.partilhaService.obterArquivoComprovante(t).subscribe((function(t){return t}),(function(t){return t}),(function(){return o.downloadComprovante[t._id]=!1}))}}]),t}(),E.\u0275fac=function(t){return new(t||E)(p.Sb(f.c),p.Sb(l.a),p.Sb(v.a),p.Sb(h.N),p.Sb(h.Ab))},E.\u0275cmp=p.Mb({type:E,selectors:[["ngx-partilha-lista"]],decls:93,vars:38,consts:[[1,"row"],[1,"col-md-8"],[3,"formGroup"],[1,"form-group","row"],[1,"form-group","col-md-4"],[1,"label"],["formControlName","status","fullWidth",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","mes","fullWidth",""],["formControlName","ano","fullWidth",""],[3,"value"],[1,"col-md-4"],["formControlName","usuario","nbInput","","type","text","placeholder","Usu\xe1rio","fullWidth","",3,"nbAutocomplete"],[3,"handleDisplayFn"],["auto",""],["fullWidth","","nbInput","","formControlName","dataPrevistaRecebimento",3,"nbDatepicker"],["dp",""],["nbButton","",3,"click"],["nbSpinnerStatus","primary",3,"nbSpinner"],[1,"col-md-7"],[1,"col-md-5"],[1,"col"],[1,"own-scroll",3,"showToggleButton","flipped"],["nbTooltip","Alterar status dos envios de comprovantes selecionados","nbTooltipStatus","primary","nbButton","","status","basic","size","tiny",3,"disabled","click"],[3,"icon"],[4,"ngFor","ngForOf"],["icon","arrow-left-outline",3,"click"],[4,"ngIf"],["class","col",4,"ngIf"],["nbButton","","ghost","","status","info",3,"nbSpinner","click"],["icon","download-outline"],["nbButton","","ghost","","status","primary",3,"click"],["icon","arrow-forward-outline"],[3,"checked","checkedChange"]],template:function(t,o){if(1&t&&(p.Yb(0,"div",0),p.Yb(1,"div",1),p.Yb(2,"nb-card"),p.Yb(3,"nb-card-header"),p.Jc(4,"Gest\xe3o Partilha solid\xe1ria"),p.Xb(),p.Yb(5,"nb-card-body"),p.Yb(6,"form",2),p.Yb(7,"div",3),p.Yb(8,"div",4),p.Yb(9,"label",5),p.Jc(10,"Status"),p.Xb(),p.Yb(11,"nb-select",6),p.Hc(12,w,2,2,"nb-option",7),p.Xb(),p.Xb(),p.Yb(13,"div",4),p.Yb(14,"label",5),p.Jc(15,"M\xeas"),p.Xb(),p.Yb(16,"nb-select",8),p.Hc(17,S,2,2,"nb-option",7),p.Xb(),p.Xb(),p.Yb(18,"div",4),p.Yb(19,"label",5),p.Jc(20,"Ano"),p.Xb(),p.Yb(21,"nb-select",9),p.Yb(22,"nb-option",10),p.Jc(23),p.Xb(),p.Yb(24,"nb-option",10),p.Jc(25),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(26,"div",0),p.Yb(27,"div",11),p.Yb(28,"label",5),p.Jc(29,"Seminarista"),p.Xb(),p.Tb(30,"input",12),p.Yb(31,"nb-autocomplete",13,14),p.Hc(33,A,2,2,"nb-option",7),p.lc(34,"async"),p.Xb(),p.Xb(),p.Yb(35,"div",11),p.Yb(36,"label",5),p.Jc(37,"Data Prevista Recebimento"),p.Xb(),p.Tb(38,"input",15),p.Tb(39,"nb-datepicker",null,16),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(41,"nb-card-footer"),p.Yb(42,"button",17),p.gc("click",(function(){return o.buscar()})),p.Jc(43,"Buscar"),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(44,"div",11),p.Yb(45,"nb-card",18),p.Yb(46,"nb-card-header"),p.Jc(47),p.lc(48,"currency"),p.Xb(),p.Yb(49,"nb-card-body"),p.Yb(50,"nb-list"),p.Yb(51,"nb-list-item"),p.Yb(52,"div",19),p.Jc(53," Valor total doado: "),p.Xb(),p.Yb(54,"div",20),p.Jc(55),p.lc(56,"currency"),p.Xb(),p.Xb(),p.Yb(57,"nb-list-item"),p.Yb(58,"div",19),p.Jc(59," Valor total depositado: "),p.Xb(),p.Yb(60,"div",20),p.Jc(61),p.lc(62,"currency"),p.Xb(),p.Xb(),p.Yb(63,"nb-list-item"),p.Yb(64,"div",19),p.Jc(65," Quantidade seminaristas: "),p.Xb(),p.Yb(66,"div",20),p.Jc(67),p.Xb(),p.Xb(),p.Yb(68,"nb-list-item"),p.Yb(69,"div",19),p.Jc(70," faltam enviar: "),p.Xb(),p.Yb(71,"div",20),p.Jc(72),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(73,"div",0),p.Yb(74,"div",21),p.Yb(75,"nb-flip-card",22),p.Yb(76,"nb-card-front",18),p.Yb(77,"nb-card"),p.Yb(78,"nb-card-header"),p.Jc(79,"Lista "),p.Yb(80,"button",23),p.gc("click",(function(){return o.alterarStatus()})),p.Tb(81,"fa-icon",24),p.Xb(),p.Xb(),p.Yb(82,"nb-card-body"),p.Hc(83,D,19,13,"nb-list-item",25),p.Xb(),p.Xb(),p.Xb(),p.Yb(84,"nb-card-back"),p.Yb(85,"nb-card"),p.Yb(86,"nb-card-header"),p.Yb(87,"nb-icon",26),p.gc("click",(function(){return o.verAtividade=!1})),p.Xb(),p.Jc(88),p.Xb(),p.Yb(89,"nb-card-body"),p.Hc(90,I,2,0,"div",27),p.Yb(91,"nb-list"),p.Hc(92,O,7,3,"nb-list-item",25),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb()),2&t){var i=p.yc(32),a=p.yc(40);p.Fb(6),p.rc("formGroup",o.form),p.Fb(6),p.rc("ngForOf",o.statuss),p.Fb(5),p.rc("ngForOf",o.meses),p.Fb(5),p.rc("value",o.anoAtual-1),p.Fb(1),p.Kc(o.anoAtual-1),p.Fb(1),p.rc("value",o.anoAtual),p.Fb(1),p.Kc(o.anoAtual),p.Fb(5),p.rc("nbAutocomplete",i),p.Fb(1),p.rc("handleDisplayFn",o.viewHandle),p.Fb(2),p.rc("ngForOf",p.mc(34,27,o.usuarios)),p.Fb(5),p.rc("nbDatepicker",a),p.Fb(7),p.rc("nbSpinner",o.loadingInfo),p.Fb(2),p.Lc("Valor em caixa: ",p.nc(48,29,o.caixa,"R$"),""),p.Fb(8),p.Lc(" ",p.nc(56,32,o.doado,"R$")," "),p.Fb(6),p.Lc(" ",p.nc(62,35,o.depositado,"R$")," "),p.Fb(6),p.Lc(" ",o.enviaram," "),p.Fb(5),p.Lc(" ",o.faltam," "),p.Fb(3),p.rc("showToggleButton",!1)("flipped",o.verAtividade),p.Fb(1),p.rc("nbSpinner",o.loadingLista),p.Fb(4),p.rc("disabled",!o.podeAlterar()),p.Fb(1),p.rc("icon",o.faExchangeAlt),p.Fb(2),p.rc("ngForOf",o.comprovantes),p.Fb(5),p.Mc("",o.comprovanteEscolhido&&o.comprovanteEscolhido.usuario.name," - ",o.comprovanteEscolhido&&o.mes(o.comprovanteEscolhido.mes).mes," "),p.Fb(2),p.rc("ngIf",!o.comprovanteEscolhido||!o.comprovanteEscolhido.atividades||!o.comprovanteEscolhido.atividades.length),p.Fb(2),p.rc("ngForOf",o.comprovanteEscolhido&&o.comprovanteEscolhido.atividades)}},directives:[h.x,h.A,h.w,f.z,f.o,f.g,h.mb,f.n,f.f,a.m,h.jb,f.b,h.S,h.r,h.q,h.J,h.I,h.y,h.t,h.ub,h.bb,h.cb,h.O,h.z,h.Db,C.a,h.v,h.P,a.n,h.D],pipes:[a.b,a.d],styles:[".item[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between}.item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1}.item[_ngcontent-%COMP%]:first-child{border-top:none}"]}),E)}],M=((_=function t(){_classCallCheck(this,t)}).\u0275mod=p.Qb({type:_}),_.\u0275inj=p.Pb({factory:function(t){return new(t||_)},imports:[[n.g.forChild(L)],n.g]}),_),P=i("oG2T"),T=i("O+SD"),j=((x=function t(){_classCallCheck(this,t)}).\u0275mod=p.Qb({type:x}),x.\u0275inj=p.Pb({factory:function(t){return new(t||x)},imports:[[a.c,M,h.B,h.db,h.R,h.T,h.u,f.u,f.h,h.nb,h.s,h.E,h.K,h.L.forChild(),P.a.forChild({format:"dd/MM/yyyy"}),m.b.forRoot(T.customCurrencyMaskConfig),C.b,h.Eb,h.vb]]}),x)}}]);